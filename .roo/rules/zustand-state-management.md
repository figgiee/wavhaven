---
description: 
globs: src/stores/**/*.ts,src/components/**/*.ts,src/components/**/*.tsx,src/app/**/*.ts,src/app/**/*.tsx
alwaysApply: false
---
---
ruleType: Auto Attached
filePatterns:
  - "src/stores/**/*.ts"           # Where stores are defined
  - "src/components/**/*.{ts,tsx}" # Components consuming stores
  - "src/app/**/*.{ts,tsx}"      # Pages/layouts potentially interacting with stores
description: Conventions for using Zustand for global client-side state, focusing on the persisted shopping cart for guests/users in Wavhaven.
---
# Zustand State Management Conventions for Wavhaven

- **Purpose:** Use **Zustand** for managing global client-side state, primarily the shopping cart.
- **Store Location:** Define stores in the `src/stores/` directory (e.g., `src/stores/cartStore.ts`).
- **Cart State:** The cart store must handle adding/removing items (`CartItem` type needs `licenseId`, `trackTitle`, `price`, etc.) and clearing the cart.
- **Persistence:** Use Zustand's `persist` middleware to save the cart state to **localStorage**. This is crucial for supporting guest users across page loads/sessions. Configure the `persist` middleware appropriately (e.g., name the storage key).
- **Usage:** Access the store in Client Components using the hook generated by `create` (e.g., `useCartStore`). Use selectors for performance optimization if the store becomes complex.